<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Pengeluaran Sparepart</title>
<style>
/* 1) dasar tampilan */
body{
  font-family: Calibri, Arial, sans-serif;
  background: #f2f2f2;
  padding: 12px;   /* dikurangi sedikit agar lebih lapang di layar kecil */
  margin: 0;
}

/* 2) container tabel fleksibel */
.table-container {
  width: 100%;
  overflow-x: auto; /* kalau tabel tetap terlalu lebar, muncul scroll horizontal kecil */
  margin-bottom: 16px;
}

/* 3) tabel menyesuaikan lebar layar */
table{
  border-collapse: collapse;
  width: 100%;      /* selalu sesuaikan dengan lebar container */
  max-width: 600px; /* optional: agar tidak terlalu melebar di layar besar */
  background: #fff;
  font-size: 14px;  /* ukuran teks pas untuk mobile */
}

/* 4) sel dan label */
td{
  border: 1px solid #333;
  padding: 6px;     /* dikurangi sedikit untuk ruang lebih di layar kecil */
  vertical-align: top;
}

.label{
  background: #cce5ff;
  font-weight: bold;
  width: 35%;       /* persentase, bukan nilai tetap */
}

/* 5) inputan menyesuaikan */
input, select, textarea{
  width: 100%;
  padding: 6px;
  box-sizing: border-box;
  font-size: 14px;
}

.upper{
  text-transform: uppercase;
}

textarea{
  resize: vertical;
}

/* 6) tombol */
button{
  padding: 10px 15px;
  margin-right: 8px;
  margin-top: 8px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
}

.add{ background: #28a745; color: #fff; }
.gen{ background: #ffc107; }
.copy{ background: #007bff; color: #fff; }

/* 7) output area */
pre{
  background: #fff;
  border: 1px solid #333;
  padding: 12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* 8) baris input campuran */
.inline{
  display: flex;
  gap: 5px;
}

/* 9) penyesuaian untuk layar sangat kecil */
@media (max-width: 360px) {
  table { font-size: 13px; }
  button { padding: 8px 12px; font-size: 13px; }
}
</style>
</head>

<body>

<h2>Input Pengeluaran Sparepart</h2>

<div id="forms"></div>

<button class="add" onclick="addForm()">âž• Tambah Invoice</button>
<button class="gen" onclick="generate()">Generate</button>

<pre id="output"></pre>
<button class="copy" onclick="copyText()">Copy</button>

<script>
function addForm(){
  const div = document.createElement('div');
  div.classList.add('table-container'); // bungkus dalam container responsif
  div.innerHTML = `
<table>

<tr>
<td class="label">Tanggal Pengeluaran</td>
<td><input class="upper" placeholder="29 JANUARI 2026"></td>
</tr>

<tr>
<td class="label">Plat Nomor</td>
<td><input class="upper"></td>
</tr>

<tr>
<td class="label">Divisi</td>
<td>
<select>
<option value="">PILIH</option>
<option>BIP</option>
<option>TIP</option>
<option>IPLS</option>
</select>
</td>
</tr>

<tr>
<td class="label">Invoice</td>
<td><input class="upper"></td>
</tr>

<tr>
<td class="label">KM</td>
<td><input class="upper" placeholder="ANGKA SAJA"></td>
</tr>

<tr>
<td class="label">Keterangan</td>
<td class="inline">
<input>
<select>
<option value="NORMAL">Normal</option>
<option value="BAN">Ban</option>
</select>
</td>
</tr>

<tr>
<td class="label">List Barang</td>
<td><textarea rows="4" placeholder="CONTOH: BAN : 2 p"></textarea></td>
</tr>

</table>`;
  document.getElementById('forms').appendChild(div);
}
addForm();

// FORMAT ITEM
function formatItem(line){
  return line
    .replace(/\b(\d+)\s*p\b/i, '$1 PCS')
    .replace(/\b(\d+)\s*s\b/i, '$1 SET')
    .replace(/\b(\d+)\s*b\b/i, '$1 BTL')
    .replace(/\b(\d+)\s*r\b/i, '$1 ROLL');
}

// GENERATE
function generate(){
  let res='';
  document.querySelectorAll('#forms table').forEach(t=>{
    const tanggal = t.rows[0].cells[1].children[0].value.trim().toUpperCase();
    const plat = t.rows[1].cells[1].children[0].value.trim().toUpperCase();
    const div = t.rows[2].cells[1].children[0].value;
    const inv = t.rows[3].cells[1].children[0].value.trim().toUpperCase();
    const km = t.rows[4].cells[1].children[0].value.trim();
    const ket = t.rows[5].cells[1].children[0].value.trim();
    const ketType = t.rows[5].cells[1].children[1].value;
    const items = t.rows[6].cells[1].children[0].value.trim();

    if(!plat || !div || !inv) return;

    if(tanggal){
      res += `PENGELUARAN SPAREPART ${tanggal}\n\n`;
    }

    res += `*${plat}* (${div})\n`;
    res += `*#${inv}*`;
    if(km) res += ` (KM ${km})`;
    res += `\n`;

    if(ket) res += `${ket}\n`;

    if(items){
      items.split('\n').forEach(i=>{
        const line=i.trim();
        if(!line) return;

        if(ketType==="BAN" && line.toUpperCase()==="BB BALIK"){
          res += `BB BALIK\n`;
        }else{
          res += `- ${formatItem(line)}\n`;
        }
      });
    }

    res += `\n`;
  });

  document.getElementById('output').textContent = res.trim();
}

function copyText(){
  navigator.clipboard.writeText(document.getElementById('output').textContent);
  alert('Berhasil di-copy');
}
</script>

</body>
</html>